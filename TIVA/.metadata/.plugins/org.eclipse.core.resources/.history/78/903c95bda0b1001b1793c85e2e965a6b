#include "tm4c1294ncpdt.h"
#include <stdint.h>

//SPI Esclavo (modulo 0)

uint8_t datosE[8] = {0};
uint8_t cont;

void main(void){

    //Se activa el modulo 0 y 2 de SSI
    SYSCTL_RCGCSSI_R |= 0x05;

    //Se va a usar el puerto A para la comunicacion SPI modulo 0, se le da reloj
    SYSCTL_RCGCGPIO_R |= 0x01;

    //Se espera a que el puerto este listo
    while((SYSCTL_PRGPIO_R & 0x01) == 0 ){}

    //Habilitar la función alterna en pines 2,3,4 y 5 del puerto
    GPIO_PORTA_AHB_AFSEL_R |= 0x3C;

    //Se asigna el puerto al controlador SPI
    GPIO_PORTA_AHB_PCTL_R |= 0x00FFFF00;

    //Se habilitan los pines asociados del puerto A
    GPIO_PORTA_AHB_DEN_R |= 0x3C;

    //Configuración como ESCLAVO
    SSI0_CR1_R |= 0x04;

    //La siguiente configuración genera un 'bit rate' para 1 MHz
    SSI0_CPSR_R |= 0x08;//16

    /*
     * Formato 'Freescale SPI'
     * Se define polaridad y fase del reloj
     * 8 bits de trama
     */
    SSI0_CR0_R |= 0x0107;

    //SI NO FUNCIONA CHECAR DIRECCIONALIDAD DEL MODULO (por defecto tx)


    //Se habilitan los modulos
    SSI0_CR1_R |= 0x02;

    //llenar fifo del esclavo
    for(cont = 48; cont <= 55; cont++){

        SSI0_DR_R = cont;
    }


    //Transaccion 1

    /*for(cont = 0; cont < 8; cont++){
        SSI2_DR_R = cont+1;

        while(!(SSI2_SR_R & 0x04)){}

        datosM[cont] = SSI2_DR_R;
        datosE[cont] = SSI0_DR_R;

    }*/



    while(1){



    }





}
